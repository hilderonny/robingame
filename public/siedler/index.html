<!DOCTYPE html>
<html>

<head>
    <title>Geolocation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
    <style type="text/css">
        html,
        body,
        #map {
            width: 100%;
            height: 100%;
            margin: 0;
        }
    </style>
    <link rel="stylesheet" href="ol.css" type="text/css">
    <script src="ol.js"></script>
</head>

<body>
    <div id="map" class="map"></div>
    <script>
        var view = new ol.View({
            center: [0, 0],
            zoom: 19
        });

        var map = new ol.Map({
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.Stamen({
                        layer: 'watercolor'
                    })
                }),
                // Hier kann nun die API von http://openpoimap.org/ eingebunden werden, um POIs anzuzeigen und zu interpretieren.
                // new ol.layer.Tile({
                //     source: new ol.source.Stamen({
                //         layer: 'terrain-labels'
                //     })
                // }),
                // new ol.layer.Tile({
                //     source: new ol.source.OSM()
                // })
            ],
            target: 'map',
            controls: ol.control.defaults({
                attributionOptions: {
                    collapsible: false
                }
            }),
            view: view
        });

        var geolocation = new ol.Geolocation({
            projection: view.getProjection(),
            trackingOptions: {
                maximumAge: 10000,
                enableHighAccuracy: true,
                timeout: 600000
            }

        });

        var accuracyFeature = new ol.Feature();
        geolocation.on('change:accuracyGeometry', function () {
            accuracyFeature.setGeometry(geolocation.getAccuracyGeometry());
        });

        var positionFeature = new ol.Feature();
        positionFeature.setStyle(new ol.style.Style({
            image: new ol.style.Circle({
                radius: 6,
                fill: new ol.style.Fill({
                    color: '#3399CC'
                }),
                stroke: new ol.style.Stroke({
                    color: '#fff',
                    width: 2
                })
            })
        }));

        geolocation.on('change:position', function () {
            var coordinates = geolocation.getPosition();
            positionFeature.setGeometry(coordinates ? new ol.geom.Point(coordinates) : null);
            view.setCenter(coordinates);
        });

        new ol.layer.Vector({
            map: map,
            source: new ol.source.Vector({
                features: [accuracyFeature, positionFeature]
            })
        });

        geolocation.setTracking(true);

    </script>
</body>

</html>